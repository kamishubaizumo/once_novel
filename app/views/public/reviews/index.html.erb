<div class="mt-5 text-center">
  <h2>【<%= @novel.title %>】の感想一覧</h2>
    <p><%= link_to "感想数：#{@novel.reviews.count}", novel_reviews_path(@novel.id) %></p>
</div>

<div class="container">
  <div class="row justify-content-center">
    <div class="col-lg-6">

    <% if user_signed_in? %>
      <!--感想記入-->
      <%= form_with model: @review, url: novel_reviews_path, method: :post do |f| %>
        <%= f.label :comment,"感想を書く" %><br>
        <%= f.text_area :comment, autofocus: true, size: "50x5", class: "form-control" %>
        <%= f.submit "投稿", class: "btn btn-success mt-3" %>
      <% end %>
    <% else %>
      <div class="text-center my-3">
        <%= link_to "ログイン", new_user_session_path %>
        して感想を書く
      </div>
    <% end %>

        <!--コメント一覧-->
        <h3 class="text-center mt-3">感想一覧</h3>
        <div class="col my-4">
        <% @novel.reviews.each do |review| %>

          <div class="mt-3 border">
          <%= h(review.comment).gsub(/\r|\r\n/, "<br>").html_safe %></div>
          <div class="mt-2"><%= review.star_rate%></div>

          <div class="mb-3">
            <%= link_to user_path(review.user) do %>
              <%= review.user.name %></div>
            <% end %>
          <div class="text-right">
            <% if review.user == current_user %>
              <%= link_to "削除", novel_review_path(review.novel, review), method: :delete, class: "btn btn-danger" %>
            <% end %>
          </div>
        <% end %>
        </div>
    </div>
  </div>
</div>



      <script>
        // scriptファイルをどのidの部分に配置するかを指定
        let elem = document.querySelector('#star');
        let opt = {
          size     : 36,
          starOff:  '<%= asset_path('star-off.png') %>',
          starOn : '<%= asset_path('star-on.png') %>',
          starHalf: '<%= asset_path('star-half.png') %>',
          scoreName: 'post[rate]',
          half: true,
          //星画像の指定などのオプションをここに記述,
         };
        raty(elem,opt);
      </script>